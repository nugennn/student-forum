{% extends 'profile/base.html' %}
{% load humanize %}
{% load static %}
{% load qa_tags %}

{% block content %}

<div id="mainbar">
        <div class="d-flex ai-center mb16">
            <h1 class="flex--item fl1 fs-headline1">Questions tagged <span style="color: #6366f1;">[{{ tag.name }}]</span></h1>
        </div>

        <div class="mb16">
            <span class="s-badge s-badge__info">{{ count_questions }} question{{ count_questions|pluralize }}</span>
        </div>

        <div id="questions" class="flush-left">
            {% for question in questions %}
            <div class="question-summary" id="question-summary-{{question.id}}">
                <div class="statscontainer">
                    <div class="stats">
                        <div class="{% if question.is_answer_accepted %}status answered-accepted{% endif %}">
                            <div class="votes">
                                <span class="vote-count-post"><strong>{{question.calculate_UpVote_DownVote}}</strong></span>
                                <div class="viewcount">vote{{question.calculate_UpVote_DownVote|pluralize}}</div>
                            </div>
                        </div>
                        <div class="status {% if question.is_answer_accepted %}answered-accepted{% elif question.answer_set.all %}answered{% else %}unanswered{% endif %}">
                            <strong>{{question.count_answers}}</strong>answer{{question.count_answers|pluralize}}
                        </div>
                    </div>
                    <div class="views" title="{{question.calculate_viewers}} view{{question.calculate_viewers|pluralize}}">{{question.calculate_viewers}} view{{question.calculate_viewers|pluralize}}</div>
                </div>

                <div class="summary">
                    <h3><a href="{{question.get_absolute_url}}" class="question-hyperlink">{{question.title}}</a></h3>
                    <div class="excerpt">
                        {{question.body|truncatechars:200}}
                    </div>

                    <div class="d-flex ai-start fw-wrap">
                        <div class="flex--item">
                            <div class="d-flex gs4 fw-wrap tags">
                                {% if question.community %}
                                <span class="post-tag flex--item" style="background: #f0fdf4 !important; color: #15803d !important; border-color: #bbf7d0 !important; font-weight: 600;" title="Community: {{question.community.name}}">
                                    üìç {{question.community.name}}
                                </span>
                                {% endif %}
                                {% for tag in question.get_all_tags %}
                                <a href="{% url 'tagbadge:taggedItemsFrom_All' tag.id %}" class="post-tag flex--item" title="show questions tagged '{{tag}}'" rel="{{tag}}">{{tag}}</a>
                                {% endfor %}
                            </div>
                        </div>
                        <div class="flex--item ml-auto fl-shrink0 started mt0">
                            <div class="user-info">
                                <div class="user-action-time">
                                    <a href="{{question.get_absolute_url}}" class="started-link">{{question.lastActiveFor}}<span title="{{question.q_edited_time}}" class="relativetime">{{question.q_edited_time|naturaltime}}</span></a>
                                </div>
                                <div class="user-gravatar32" style="width: 32px; height: 32px; border-radius: 50%; overflow: hidden; margin-right: 8px;">
                                    <a href="{{question.post_owner.profile.get_absolute_url}}">
                                        <img src="{% if question.post_owner.profile.profile_photo %}{{question.post_owner.profile.profile_photo.url}}{% else %}{% static 'default.jpg' %}{% endif %}" alt="" width="32" height="32" style="object-fit: cover; width: 100%; height: 100%;">
                                    </a>
                                </div>
                                <div class="user-details">
                                    <a href="{{question.post_owner.profile.get_absolute_url}}" style="font-weight: 500;">
                                        {% if question.post_owner.profile.full_name %}
                                            {{ question.post_owner.profile.full_name }}
                                        {% else %}
                                            {{ question.post_owner }}
                                        {% endif %}
                                    </a>
                                    <div class="-flair">
                                        <span class="reputation-score" title="reputation score" dir="ltr">{{question.post_owner|calculate_reputation}}</span>

                                        {% if question.post_owner|calculateGoldBadges %}
                                            <span title="{{question.post_owner|calculateGoldBadges}} gold badges" aria-hidden="true">
                                                <span class="badge1"></span>
                                                <span class="badgecount">{{question.post_owner|calculateGoldBadges}}</span>
                                            </span>
                                        {% endif %}

                                        {% if question.post_owner|calculatSilvereBadges %}
                                            <span title="{{question.post_owner|calculatSilvereBadges}} silver badges" aria-hidden="true">
                                                <span class="badge2"></span>
                                                <span class="badgecount">{{question.post_owner|calculatSilvereBadges}}</span>
                                            </span>
                                        {% endif %}

                                        {% if question.post_owner|calculateBronzeBadges %}
                                            <span title="{{question.post_owner|calculateBronzeBadges}} bronze badges" aria-hidden="true">
                                                <span class="badge3"></span>
                                                <span class="badgecount">{{question.post_owner|calculateBronzeBadges}}</span>
                                            </span>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

    </div>

{% endblock content %}
